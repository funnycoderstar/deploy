(window.webpackJsonp=window.webpackJsonp||[]).push([[160],{158:function(t,e,a){"use strict";a.r(e);var s=a(0),n=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h4",{attrs:{id:"微信小程序-this和that详解及简单实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微信小程序-this和that详解及简单实例","aria-hidden":"true"}},[t._v("#")]),t._v(" 微信小程序 this和that详解及简单实例")]),t._v(" "),a("ul",[a("li",[t._v("微信小程序中，在wx.request({});方法调用成功或者失败之后，有时候会需要获取页面初始化数据data的情况，这个时候，如果使用，this.data来获取，会出现获取不到的情况，调试页面也会报undefiend。原因是，在javascript中，this代表着当前对象，会随着程序的执行过程中的上下文改变，在wx.request({});方法的回调函数中，对象已经发生改变，所以已经不是wx.request({});方法对象了，data属性也不存在了。官方的解决办法是，复制一份当前的对象，如下：")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("var that=this;//把this对象复制到临时变量that\n")])])]),a("ul",[a("li",[t._v("在success回调函数中使用that.data就能获取到数据了。\n不过，还有另外一种方式，也很特别，是将success回调函数换一种声明方式，如下：")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("success: res =>{\n  this.setData({\n      loadingHidden: true,\n      hideCommitSuccessToast: false\n  })\n}\n")])])]),a("ul",[a("li",[t._v("在这种方式下，this可以直接使用，完全可以获取到data数据。\n再给一个完整的例子：")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("success: res => {\n  if (res.data.code != 0) {\n   // 提交失败\n   this.setData({\n    loadingHidden: true,\n    hiddenTips: false,\n    tipsContent: res.data.message\n   })\n  } else {\n   // 提交成功\n   this.setData({\n    loadingHidden: true,\n    hideCommitSuccessToast: false\n   })\n   subBtn = false;\n \n   // 定时，3秒消失\n   setTimeout(() => {\n    this.setData({\n     hideCommitSuccessToast: true\n    })\n    wx.navigateBack({ delta: 2 });\n   }, 2000);\n \n  }\n }\n")])])]),a("p",[t._v("本文转自"),a("a",{attrs:{href:"http://www.jb51.net/article/105467.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("转载"),a("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=n.exports}}]);